(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{1015:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return a(7886)}])},7886:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return S}});var n=a(5893),s=a(9008),l=a.n(s),r=a(5986),o=a.n(r),d=a(7294),i=a(9548),c=a(1163),u=a(1955);let h=e=>{let[t,a,n]=e.split("-");return"".concat(a,"/").concat(n,"/").concat(t).toString()};function m(e){var t,a;let s,{selectedAge:l,selectedGender:r,selectedStartDate:m,selectedEndDate:g,setSelectedAge:x,setSelectedGender:p,setSelectedStartDate:f,setSelectedEndDate:j}=e,{updateAuthStatus:v,updateUserId:_}=(0,d.useContext)(i.V),[D,N]=(0,d.useState)(0),S=(0,c.useRouter)(),w=(0,d.useRef)(),y=(0,d.useRef)(),[b,C]=(0,d.useState)(null),k=S.asPath,E={},A=/([^=&?]+)=([^=&?]+)/g;for(;null!==(s=A.exec(k));)E[s[1]]=decodeURIComponent(s[2]);function Z(e){e===D?N(0):N(e)}function O(e){x(e.target.value)}function F(e){p(e.target.value)}return console.log(E),(0,d.useEffect)(()=>{if(console.log("use effect menuBar"),E.age){let e=E.age;e&&(x(e),u.Z.set("selectedAge",e))}if(E.gender){let e=E.gender;e&&(p(e),u.Z.set("selectedGender",e))}if(E.startDate){let e=E.startDate;e&&(f(e),u.Z.set("selectedStartDate",e))}if(E.endDate){let e=E.endDate;e&&(j(e),u.Z.set("selectedEndDate",e))}},[E.age,E.gender,E.startDate,E.endDate]),(0,n.jsxs)("div",{className:o().menuBar,children:[(0,n.jsxs)("header",{children:[(0,n.jsx)("p",{children:"\uD83D\uDCCA DataLens"}),(0,n.jsxs)("div",{className:o().headerButtons,children:[(0,n.jsx)("button",{onClick:()=>{let e=encodeURIComponent(l||""),t=encodeURIComponent(r||""),a=encodeURIComponent(m||""),n=encodeURIComponent(g||""),s="".concat(window.location.origin,"/dashboard?").concat(e?"age=".concat(e,"&"):"age=&").concat(t?"gender=".concat(t,"&"):"gender=&").concat(a?"startDate=".concat(a,"&"):"startDate=&").concat(n?"endDate=".concat(n):"endDate=");navigator.clipboard.writeText(s),alert("Chart link copied. Share it with your team.")},children:(0,n.jsx)("img",{height:18,width:18,src:"/share.png"})}),(0,n.jsx)("button",{onClick:()=>{localStorage.removeItem("userId"),v(!1),_(void 0),S.push("/")},children:"Logout"})]})]}),(0,n.jsxs)("nav",{className:o().filters,children:[(0,n.jsxs)("li",{children:[(0,n.jsxs)("p",{className:o().filterName,onClick:()=>Z(1),children:["Time Range ",(0,n.jsx)("img",{src:"/down-arrow.png"})]}),1===D&&(0,n.jsx)("div",{className:o().dropdownMenu,children:(0,n.jsxs)("form",{className:o().timeRangeForm,onSubmit:function(e){e.preventDefault();let t=h(w.current.value),a=h(y.current.value);new Date(t)>new Date(a)?(C("Start date should not be greater than endDate"),w.current.value=null,y.current.value=null):(C(null),f(t),j(a),N(0))},children:[b&&(0,n.jsx)("span",{style:{color:"red"},children:b}),(0,n.jsx)("p",{children:(null===(t=w.current)||void 0===t?void 0:t.value)?"From - ".concat(w.current.value):"From"}),(0,n.jsx)("input",{type:"date",name:"start-date",ref:w,required:!0,min:"2022-10-03",max:"2022-10-29"}),(0,n.jsx)("p",{children:(null===(a=y.current)||void 0===a?void 0:a.value)?"to - ".concat(y.current.value):"To"}),(0,n.jsx)("input",{type:"date",name:"end-date",ref:y,required:!0,min:"2022-10-03"}),(0,n.jsx)("button",{children:"Apply"})]})})]}),(0,n.jsxs)("li",{children:[(0,n.jsxs)("p",{className:o().filterName,onClick:()=>Z(2),children:["Age ",(0,n.jsx)("img",{src:"/down-arrow.png"})]}),2===D&&(0,n.jsxs)("div",{className:o().dropdownMenu,children:[(0,n.jsxs)("span",{children:[(0,n.jsx)("input",{type:"radio",name:"Age",alt:"15-25",value:"15-25",checked:"15-25"===l,onChange:O})," 15-25"]}),(0,n.jsxs)("span",{children:[(0,n.jsx)("input",{type:"radio",name:"Age",alt:">25",value:">25",checked:">25"===l,onChange:O})," >25"]})]})]}),(0,n.jsxs)("li",{children:[(0,n.jsxs)("p",{className:o().filterName,onClick:()=>Z(3),children:["Gender ",(0,n.jsx)("img",{src:"/down-arrow.png"})]}),3===D&&(0,n.jsxs)("div",{className:o().dropdownMenu,children:[(0,n.jsxs)("span",{children:[(0,n.jsx)("input",{type:"radio",name:"Gender",alt:"Male",value:"Male",checked:"Male"===r,onChange:F})," Male"]}),(0,n.jsxs)("span",{children:[(0,n.jsx)("input",{type:"radio",name:"Gender",alt:"Female",value:"Female",checked:"Female"===r,onChange:F})," Female"]})]})]}),(0,n.jsx)("li",{className:o().filterButtons,children:(0,n.jsx)("button",{onClick:()=>{x(null),p(null),f(null),j(null),u.Z.set("selectedAge",null),u.Z.set("selectedGender",null),u.Z.set("selectedStartDate",null),u.Z.set("selectedEndDate",null)},children:"Clear"})})]})]})}var g=a(3870),x=a(7209),p=a(3091),f=a(2486),j=a(8316),v=a(5168);function _(e){let{filterOption:t}=e,a=t.age,s=t.gender,l=t.startDate,r=t.endDate;console.log(t);let[i,c]=(0,d.useState)(void 0),[u,h]=(0,d.useState)(void 0),[m,_]=(0,d.useState)(void 0),[D,N]=(0,d.useState)(void 0),S=e=>e.map(e=>{let[t,a,n]=e.Day.split("/");return{...e,Day:"".concat(a,"/").concat(t,"/").concat(n).toString()}});return(0,d.useEffect)(()=>{(async()=>{_(void 0);let e=await fetch("/api/data"),t=S(await e.json()).filter(e=>{let t,n,o=!a||a===e.Age,d=!s||s===e.Gender,i=new Date(e.Day);return t=!l||i>=new Date(l),n=!r||i<=new Date(r),t&&n&&d&&o});c(t);let n=t.reduce((e,t)=>{for(let a of["A","B","C","D","E","F"]){let n=parseInt(t[a]);e[a]=(e[a]||0)+n}return e},{});h(Object.keys(n).map(e=>({feature:e,time:parseInt(n[e])})))})()},[a,s,l,r]),(0,n.jsxs)("div",{className:o().chartsContainer,children:[u&&(0,n.jsxs)("div",{className:o().chart,children:[(0,n.jsx)("p",{className:o().chartName,children:"Total Time Spent on Features"}),(0,n.jsxs)(g.k,{domainPadding:{x:20},height:500,width:500,theme:x.J.grayscale,children:[(0,n.jsx)(p.E,{label:"Feature"}),(0,n.jsx)(p.E,{dependentAxis:!0,label:"Total Time"}),(0,n.jsx)(f.u,{events:[{target:"data",eventHandlers:{onClick:e=>{let t=event.target;if("path"===t.tagName){let e=t.getAttribute("index");console.log("Clicked bar index:",e),function(e){let t=["A","B","C","D","E","F"],a=i.map(a=>{let[n,s,l]=a.Day.split("/");return{x:"".concat(s,"/").concat(n).toString(),y:parseInt(a[t[e]])}});N(t[e]),console.log(a);let n=Object.values(a.reduce((e,t)=>{let a=t.x;return e[a]=e[a]||{x:t.x,y:0,count:0},e[a].y+=t.y,e[a].count++,e},{})).map(e=>({x:e.x,y:e.y}));_(n),console.log(n)}(e)}console.log(m)}}}],animate:{duration:1e3,easing:"linear",onLoad:{duration:500}},style:{data:{fill:"red",fontSize:10},labels:{fill:"red",fontSize:10}},horizontal:!0,data:u,x:"feature",y:"time"})]})]}),m&&(0,n.jsxs)("div",{className:o().chart,children:[(0,n.jsxs)("p",{className:o().chartName,children:["Time Trend of Feature ",D]}),(0,n.jsxs)(g.k,{containerComponent:(0,n.jsx)(j.U5,{zoomDimension:"x"}),height:500,width:500,theme:x.J.grayscale,children:[(0,n.jsx)(p.E,{label:"days",tickCount:5}),(0,n.jsx)(p.E,{dependentAxis:!0,label:"Total Time",tickCount:10}),(0,n.jsx)(v.j,{animate:{duration:500,onLoad:{duration:500}},data:m,style:{data:{stroke:"blue"},labels:{fill:"red",fontSize:10}},x:"x",y:"y"})]})]})]})}var D=a(1664),N=a.n(D);function S(){let{isAuthenticated:e}=(0,d.useContext)(i.V),[t,a]=(0,d.useState)(null),[s,r]=(0,d.useState)(null),[h,g]=(0,d.useState)(null),[x,p]=(0,d.useState)(null),f=(0,c.useRouter)();return e||u.Z.set("paramsUrl",JSON.stringify(f.asPath)),(0,d.useEffect)(()=>{(async()=>{try{console.log("use effect 1");let e=await u.Z.get("selectedAge"),t=await u.Z.get("selectedGender"),n=await u.Z.get("selectedStartDate"),s=await u.Z.get("selectedEndDate");null!=e&&g(JSON.parse(e)),null!=t&&p(JSON.parse(t)),null!=n&&a(JSON.parse(n)),null!=n&&r(JSON.parse(s))}catch(e){console.log(e)}})()},[]),(0,d.useEffect)(()=>{console.log("use effect 2"),h&&u.Z.set("selectedAge",JSON.stringify(h)),x&&u.Z.set("selectedGender",JSON.stringify(x)),t&&u.Z.set("selectedStartDate",JSON.stringify(t)),s&&u.Z.set("selectedEndDate",JSON.stringify(s))},[h,x,t,s]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l(),{children:[(0,n.jsx)("title",{children:" Data Visualization"}),(0,n.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsxs)("main",{className:o().main,children:[!e&&(0,n.jsxs)("div",{className:o().loginMessage,children:[(0,n.jsx)("h3",{children:"You need to be logged in to view this dashboard."}),(0,n.jsx)(N(),{href:"/auth/login",children:"Login"})]}),e&&(0,n.jsxs)("div",{className:o().pageContent,children:[(0,n.jsx)(m,{selectedAge:h,selectedGender:x,selectedStartDate:t,selectedEndDate:s,setSelectedAge:g,setSelectedGender:p,setSelectedStartDate:a,setSelectedEndDate:r}),(0,n.jsx)(_,{filterOption:{age:h||null,gender:x||null,startDate:t||null,endDate:s||null}})]})]})]})}},5986:function(e){e.exports={main:"dashboard_main__PAsP9",loginMessage:"dashboard_loginMessage__x3qKE",pageContent:"dashboard_pageContent__NughN",menuBar:"dashboard_menuBar__n2Kd7",headerButtons:"dashboard_headerButtons__PD5wO",filters:"dashboard_filters__yvZS2",filterName:"dashboard_filterName__Ahpo7",dropdownMenu:"dashboard_dropdownMenu__CD6Kz",timeRangeForm:"dashboard_timeRangeForm__2W7W5",filterButtons:"dashboard_filterButtons__4ByOz",chartsContainer:"dashboard_chartsContainer__iyWIr",chartName:"dashboard_chartName__Q25z8",chart:"dashboard_chart__vCfdm"}}},function(e){e.O(0,[996,121,888,774,179],function(){return e(e.s=1015)}),_N_E=e.O()}]);